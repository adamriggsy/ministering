(()=>{"use strict";var t,e,o=(t={commentTemplate:null},{data:(e={init:function(t){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}})},setDataAttr:function(e,o){t[e]=o},getDataAttr:function(e){return t[e]},getAllData:function(){return t},createComment:function(t){$.ajax({url:t.url,type:"post",data:t.data,success:function(e){t.successCallback(e)}})},buildComments:function(e,o,n){void 0===n&&(n="No comments yet."),e.html(""),0===o.length?e.html("<p>"+n+"</p>"):$.each(o,(function(o,n){var a=n.author;void 0===a&&(a=n.authorInfo);var m=a.name+" - "+_moment(n.updated_at).format("YYYY-MM-DD LT"),r=t.commentTemplate(n.id,n.body,m);e.prepend(r)}))},setCommentError:function(t,e){t.html(e)},resetCommentForm:function(t){t.reset()},showCommentsAjaxLoader:function(t){t.find(".ajax-loader").removeClass("d-none")},hideCommentsAjaxLoader:function(t){t.find(".ajax-loader").addClass("d-none")}}).getAllData,functions:e});window.householdsHelper=function(){var t={households:null,currentHouseholdId:null},e=e={mainContainer:"#householdsContainer",modals:{comment:"#commentModal",household:{container:"#householdModal",comments:".allComments"}},comments:{form:"#newComment",formError:"#commentError"},household:{container:".household",comments:".allComments"}},n=function(t,e,o){return"\n            <div class='householdComment' data-commentid=\"".concat(t,'">\n                <author>').concat(o,'</author>\n                <p class="commentBody">').concat(e,"</p>\n            </div>\n        ")},a={init:function(t){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),a.setDataAttr("households",t),o.functions.init(),o.functions.setDataAttr("commentTemplate",n)},setDataAttr:function(e,o){t[e]=o},getDataAttr:function(e){return t[e]},getAllData:function(){return t},getActiveContainerById:function(t){return $('[data-householdid="'+t+'"] '+e.household.comments)},createComment:function(){var t=$(e.comments.form),n=t.find("#householdId").val();a.setDataAttr("currentHouseholdId",n);var m={url:"/api/household/"+n+"/comments/create",data:{form:JSON.stringify(t.serializeArray().reduce((function(t,e){return t[e.name]=e.value,t}),{}))},successCallback:a.commentCreateSuccess};o.functions.createComment(m)},commentCreateSuccess:function(t){t.saved?(o.functions.resetCommentForm($(e.comments.form)[0]),o.functions.buildComments(a.getActiveContainerById(a.getDataAttr("currentHouseholdId")),t.comments,"No comments yet."),$(e.modals.comment).modal("hide")):o.functions.setCommentError($(e.comments.formError),"Could not save your comment. Refresh the page and try again.")},populateHouseholdModal:function(t){var n=t.closest(".household").data("householdid"),m=a.getHouseholdById(n),r=$(e.modals.household.container);a.setDataAttr("currentHouseholdId"),r.find(".householdName").text(m.fullHouseholdName),o.functions.buildComments($(e.modals.household.comments,r),m.comments,"No comments yet.")},getHouseholdById:function(e){return t.households.filter((function(t){return t.id===e}))[0]}};return $(document).on("click touch","#submitComment",(function(t){t.preventDefault(),a.createComment()})),{data:a.getAllData,functions:a}}()})();
//# sourceMappingURL=households.js.map