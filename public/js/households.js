(()=>{"use strict";var t,o,e=(t={commentTemplate:null},{data:(o={init:function(t){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}})},setDataAttr:function(o,e){t[o]=e},getDataAttr:function(o){return t[o]},getAllData:function(){return t},createComment:function(t){$.ajax({url:t.url,type:"post",data:t.data,success:function(o){t.successCallback(o)}})},buildComments:function(o,e,n){void 0===n&&(n="No comments yet."),o.html(""),0===e.length?o.html("<p>"+n+"</p>"):$.each(e,(function(e,n){var a=n.author;void 0===a&&(a=n.authorInfo);var m=a.name+" - "+_moment(n.updated_at).format("YYYY-MM-DD LT"),s=t.commentTemplate(n.id,n.body,m);o.prepend(s)}))},setCommentError:function(t,o){t.html(o)},resetCommentForm:function(t){t.reset()},showCommentsAjaxLoader:function(t){t.find(".ajax-loader").removeClass("d-none")},hideCommentsAjaxLoader:function(t){t.find(".ajax-loader").addClass("d-none")}}).getAllData,functions:o});window.householdsHelper=function(){var t={households:null,currentHouseholdId:null},o=o={mainContainer:"#householdsContainer",modals:{comment:"#commentModal",household:{container:"#householdModal",comments:".allComments"}},comments:{form:"#newComment",formError:"#commentError"},household:{container:".household"}},n=function(t,o,e){return"\n            <div class='householdComment' data-commentid=\"".concat(t,'">\n                <author>').concat(e,'</author>\n                <p class="commentBody">').concat(o,"</p>\n            </div>\n        ")},a={init:function(t){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),a.setDataAttr("households",t),e.functions.init(),e.functions.setDataAttr("commentTemplate",n)},setDataAttr:function(o,e){t[o]=e},getDataAttr:function(o){return t[o]},getAllData:function(){return t},getActiveContainerById:function(t){return $('[data-householdid="'+t+'"] '+o.household.comments)},createComment:function(){var t=$(o.comments.form),n=t.find("#householdId").val();a.setDataAttr("currentHouseholdId",n);var m={url:"/api/household/"+n+"/comments/create",data:{form:JSON.stringify(t.serializeArray().reduce((function(t,o){return t[o.name]=o.value,t}),{}))},successCallback:a.commentCreateSuccess};e.functions.createComment(m)},commentCreateSuccess:function(t){t.saved?(e.functions.resetCommentForm($(o.comments.form)[0]),e.functions.buildComments(a.getActiveContainerById(a.getDataAttr("currentHouseholdId")),t.comments,"No comments yet."),$(o.modals.comment).modal("hide")):e.functions.setCommentError($(o.comments.formError),"Could not save your comment. Refresh the page and try again.")},populateHouseholdModal:function(t){var n=t.closest(".household").data("householdid"),m=a.getHouseholdById(n),s=$(o.modals.household.container);a.setDataAttr("currentHouseholdId"),console.log(s),console.log(s.find(".householdName")),console.log($(o.modals.household.comments,s)),s.find(".householdName").text(m.fullHouseholdName),e.functions.buildComments($(o.modals.household.comments,s),m.comments,"No comments yet.")},getHouseholdById:function(o){return t.households.filter((function(t){return t.id===o}))[0]}};return $(document).on("click touch","#submitComment",(function(t){t.preventDefault(),a.createComment()})),{data:a.getAllData,functions:a}}()})();
//# sourceMappingURL=households.js.map